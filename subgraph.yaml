specVersion: 0.0.4
description: Subgraph for Vision v1 smart contracts on Polygon
repository: https://github.com/Vision-DAO/v1-subgraph
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: Factory
    network: mumbai
    source:
      address: "0x615198957E21681287E206aA38F14f9F8636D7b2"
      abi: Factory
      startBlock: 27802787
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Registry
      abis:
        - name: Factory
          file: ./value-tree/build/contracts/Factory.json
      eventHandlers:
        - event: IdeaCreated(address,address)
          handler: handleIdeaCreated
        - event: FactoryCreated(address)
          handler: handleFactoryCreated
      file: ./src/mappings/factory.ts
templates:
  - name: Idea
    kind: ethereum/contract
    network: mumbai
    source:
      abi: Idea
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Idea
        - Prop
        - InvestorProfile
      abis:
        - name: Idea
          file: ./value-tree/build/contracts/Idea.json
      eventHandlers:
        - event: IdeaRecorded(string)
          handler: handleIdeaRecorded
        - event: IdeaFunded(address,(address,uint256,uint256,uint256,uint256,uint8))
          handler: handleIdeaFunded
        - event: ProposalRejected(address)
          handler: handleProposalRejected
        - event: FundingDispersed(address,(address,uint256,uint256,uint256,uint256,uint8))
          handler: handleFundingDispersed
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/mappings/idea.ts
  - name: Proposal
    kind: ethereum/contract
    network: mumbai
    source:
      abi: Proposal
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Prop
        - AuthorProfile
        - VoterProfile
        - InvestorProfile
        - (address,uint256,uint256,uint256,uint256,uint8)
      abis:
        - name: Proposal
          file: ./value-tree/build/contracts/Prop.json
      eventHandlers:
        - event: NewProposal(address,address,string,uint256)
          handler: handleNewProposal
      callHandlers:
        - function: vote(uint256,(address,uint256,uint256,uint256,uint256,uint8))
          handler: handleVote
      file: ./src/mappings/prop.ts
